!function(e,t){"use strict";const r={components:{Error:{data:()=>({}),props:{errors:{type:Array,default:[]}},methods:{},template:'\n            <div class="alert alert-danger" role="alert">\n              <h4 class="alert-heading">Ошибка!</h4>\n              <template v-for="(value, index) in errors" :key="index">\n                <p class="error">{{ value.message }}</p>\n              </template>\n            </div>\n        '},GeoData:{data:()=>({}),props:{data:{type:Array,default:[]}},template:'\n            <div class="alert alert-light" role="alert">\n              <template v-for="(value, index) in data" :key="index">\n                <div><b>Город:</b> {{value.city ? value.city : \'---\' }}</div>\n                <div><b>Регион:</b> {{value.region ? value.region : \'---\' }}</div>\n                <div><b>Страна:</b> {{value.country ? value.country : \'---\' }}</div>\n              </template>\n            </div>\n        '}},data:()=>({ip:"",geoData:[],errors:[],requestInProcess:!1}),computed:{hasErrors(){return this.errors.length>0},hasGeoData(){return this.geoData.length>0}},methods:{handleSubmit(){if(!this.requestInProcess){if(this.requestInProcess=!0,this.resetErrors(),this.resetGeoData(),this.ip.trim().length<1)return this.requestInProcess=!1,void this.errors.push({message:"Не указан ip адрес!"});this.request()}},request(){let e=this;BX.ajax.runComponentAction("vendor:geoip","getIpInfo",{mode:"ajax",data:{ip:e.ip}}).then((function(t){e.requestInProcess=!1,"object"==typeof t&&null!=t&&t.status&&"success"===t.status&&e.setGeoData([null==t?void 0:t.data])})).catch(t=>{e.requestInProcess=!1,null!=t&&t.errors&&(null==t?void 0:t.errors.length)>0&&e.setErrors(null==t?void 0:t.errors)})},setGeoData(e){this.geoData=e},resetGeoData(){this.geoData=[]},setErrors(e){this.errors=e},resetErrors(){this.errors=[]},validateInput(){this.ip=this.ip.replace(/[^\d.]/g,"")}},template:'\n            <div class="w-50 mt-5">\n                <form class="input-group mb-3" @submit.prevent="handleSubmit">\n                    <input \n                        type="text" \n                        class="form-control" \n                        placeholder="Укажите IP-адрес"\n                        v-on:input="validateInput"\n                        v-model="ip"\n                        >\n                    <button \n                        class="btn btn-outline-secondary" \n                        type="submit"\n                        id="button-addon2"\n                    >\n                        Показать\n                    </button>\n                </form>\n                <template v-if="hasGeoData">\n                   <GeoData :data="geoData" />\n                </template>\n                <template v-if="hasErrors">\n                   <Error :errors="errors" />\n                </template>\n            </div>\n        '};e.Application=class{constructor(e){this.rootNode=document.querySelector(e)}start(){this.attachTemplate()}attachTemplate(){t.BitrixVue.createApp({name:"Application",components:{GeoIp:r},template:"<GeoIp/>"}).mount(this.rootNode)}}}(this.BX=this.BX||{},BX.Vue3);
//# sourceMappingURL=application.bundle.js.map
